<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>城市伴讀 | 西班牙旅遊助手</title>
    <!-- Tailwind CSS (樣式) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel (核心) -->
    <script type="importmap">
        {
            "imports": {
                "react": "https://esm.sh/react@18.2.0",
                "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
                "lucide-react": "https://esm.sh/lucide-react@0.344.0"
            }
        }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* 隱藏滾動條但保留功能 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        body {
            background-color: #f9fafb;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { Sun, Cloud, CloudRain, Snowflake, Moon, Sunrise, Sunset, MapPin, Camera, BookOpen, Utensils, Clock, Info, ChevronRight, Star, Instagram, Loader, Hash, Lightbulb, Search, FileText, ShoppingBag, Gift, Euro, Navigation } from 'lucide-react';

        // 城市座標配置
        const cityConfigs = {
            madrid: { lat: 40.4168, lon: -3.7038 },
            seville: { lat: 37.3891, lon: -5.9845 },
            granada: { lat: 37.1773, lon: -3.5986 },
            barcelona: { lat: 41.3851, lon: 2.1734 }
        };

        const CityCompanion = () => {
            const [activeCity, setActiveCity] = useState('barcelona');
            const [currentTime, setCurrentTime] = useState(new Date());
            const [weatherData, setWeatherData] = useState(null);
            const [loadingWeather, setLoadingWeather] = useState(false);

            // Refs
            const attractionsRef = useRef(null);
            const hiddenGemsRef = useRef(null);
            const shoppingRef = useRef(null);
            const foodRef = useRef(null);

            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(new Date()), 60000);
                return () => clearInterval(timer);
            }, []);

            useEffect(() => {
                const fetchWeather = async () => {
                    setLoadingWeather(true);
                    const coords = cityConfigs[activeCity]; 
                    if (!coords) { setLoadingWeather(false); return; }
                    try {
                        const response = await fetch(
                            `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current=temperature_2m,weather_code,is_day&daily=sunrise,sunset&timezone=Europe%2FMadrid`
                        );
                        const data = await response.json();
                        setWeatherData(data);
                    } catch (error) {
                        console.error("Weather fetch failed", error);
                        setWeatherData(null);
                    } finally {
                        setLoadingWeather(false);
                    }
                };
                fetchWeather();
            }, [activeCity]);

            const scrollToSection = (ref) => ref.current?.scrollIntoView({ behavior: 'smooth', block: 'start' });
            const scrollToAttraction = (id) => {
                const element = document.getElementById(id);
                if (element) element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            };

            const getWeatherIcon = (code, isDay) => {
                if (code === 0) return isDay ? <Sun className="text-orange-500" size={40} /> : <Moon className="text-indigo-300" size={40} />;
                if (code >= 1 && code <= 3) return <Cloud className="text-gray-400" size={40} />;
                if (code >= 51 && code <= 67) return <CloudRain className="text-blue-400" size={40} />;
                if (code >= 71) return <Snowflake className="text-cyan-300" size={40} />;
                return <Sun className="text-orange-500" size={40} />;
            };

            const getWeatherDesc = (code) => {
                const codes = { 0: '晴朗無雲', 1: '大致晴朗', 2: '多雲', 3: '陰天', 45: '霧', 48: '白霜霧', 51: '毛毛雨', 53: '中雨', 55: '大雨', 61: '小雨', 63: '中雨', 65: '大雨', 80: '陣雨' };
                return codes[code] || '多變天氣';
            };

            const getGoogleMapsUrl = (query) => `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
            const openHashtag = (tag) => window.open(`https://www.instagram.com/explore/tags/${tag}/`, '_blank');
            const searchBlogs = (spotName) => window.open(`https://www.google.com/search?q=${encodeURIComponent(spotName + ' 歷史故事 遊記')}`, '_blank');
            const getImageUrl = (id) => `https://images.unsplash.com/photo-${id}?auto=format&fit=crop&w=800&q=80`;

            const cityData = {
                madrid: {
                    name: '馬德里',
                    attractions: [
                        {
                            name: '太陽門廣場 (Puerta del Sol)',
                            info: '全天開放 | 地鐵 Sol 站直達',
                            history: '這裡是馬德里的心臟，也是西班牙所有公路網的起點「零公里 (Km 0)」。自16世紀以來，這裡就是公眾聚會的中心，曾經歷過電車通行、政治示威與無數次的改建。來到這裡，有三個不可錯過的重點：\n\n1. 「熊與莓樹」雕像 (El Oso y el Madroño)：這是馬德里的市徽，也是最受歡迎的拍照地標。關於這隻熊是公是母爭論已久，但它象徵著這片土地曾經森林茂密、野獸出沒的原始風貌，以及中世紀教會與議會對土地所有權的協議（樹歸教會，地歸議會）。\n2. 零公里標誌：位於舊郵政大樓正前方的人行道上，傳說踩了這個標誌，未來就會再次回到馬德里。\n3. 舊郵政大樓鐘樓：這裡是西班牙人跨年的聖地。每當除夕鐘聲響起，成千上萬的市民會聚集於此，隨著12聲鐘響快速吞下12顆葡萄，這項傳統始於1909年，目的是祈求來年每個月的好運。',
                            hashtags: ['puertadelsol', 'madridspain', 'km0', 'kilometroceromadrid', 'madridcentro'],
                            tips: ['「零公里」標誌在舊郵政大樓正門前人行道上。', '人潮擁擠，請務必小心扒手。', '想拍空景建議早上9點前抵達。']
                        },
                        {
                            name: '馬德里主廣場 (Plaza Mayor)',
                            info: '全天開放 | 聖誕市集舉辦地',
                            history: '這座宏偉的長方形廣場是哈布斯堡王朝建築風格的典範，見證了西班牙帝國最輝煌與最黑暗的時刻。自1619年由建築師胡安·戈麥斯·德·莫拉完工以來，它經歷了三次大火與重建。來到主廣場，請留意以下細節：\n\n1. 麵包房之家 (Casa de la Panadería)：位於北側，是廣場上最古老也最華麗的建築，外牆繪滿了精美的神話壁畫。這裡曾是控制全城麵包價格的中心，其對面則是肉舖之家。\n2. 菲利普三世騎馬雕像：廣場中央的青銅雕像是1616年的作品，但直到19世紀才被移至此處。有趣的是，雕像的馬嘴曾經是麻雀的「死亡陷阱」，直到後來修復時才將開口封住。\n3. 237個陽台：四周被整齊劃一的紅色三層建築環繞，這些陽台在古代是皇室貴族觀看廣場活動（加冕、鬥牛或火刑）的「VIP包廂」。',
                            hashtags: ['plazamayormadrid', 'madrid', 'plazamayor', 'visitmadrid', 'madridarchitecture'],
                            tips: ['廣場內用餐較貴，建議去聖米格爾市場。', '必吃美食「炸魷魚三明治」名店 La Campana 就在拱門出口。', '週日早上有集郵錢幣市集。']
                        },
                        {
                            name: '馬德里王宮 (Palacio Real)',
                            info: '10:00 - 18:00 | 建議提前線上購票',
                            history: '這是西歐佔地面積最大的王宮，擁有超過3,418個房間，其奢華程度足以媲美法國凡爾賽宮。原址本是摩爾人的城堡（Alcázar），1734年聖誕夜的一場大火將舊皇宮燒毀，波旁王朝的菲利普五世隨即下令用石頭和磚塊重建以防範火災，這才造就了今日融合巴洛克與古典主義的壯麗外觀。參觀王宮，這幾個區域是精華：\n\n1. 王座廳 (Throne Room)：紅色天鵝絨牆面與提埃坡羅 (Tiepolo) 繪製的壯麗天頂畫，展現了西班牙君主制的威嚴。\n2. 皇家樂器室：這裡是音樂迷的聖地，收藏了世界上唯一完整的一組斯特拉迪瓦里 (Stradivarius) 弦樂四重奏樂器，價值連城。\n3. 皇家兵器庫：展示了查理五世與菲利普二世時期精良的中世紀騎士裝備，是世界上最重要的兵器收藏之一。\n4. 加斯帕里尼房間：極致奢華的洛可可風格，牆面佈滿了精細的絲綢刺繡。',
                            hashtags: ['palaciorealmadrid', 'royalpalacemadrid', 'palacioreal', 'madridmonumental', 'royalpalace'],
                            tips: ['週三週六上午11:00有衛兵交接(視情況)。', '週一至週四閉館前2小時歐盟/學生免費(需排隊)。', '內部多區禁拍，請留意標示。']
                        },
                        {
                            name: '阿穆德納聖母主教座堂',
                            info: '10:00 - 20:30 | 建議奉獻 €1',
                            history: '這座教堂的命運多舛，建造歷程長達100多年（1883-1993）。最初設計為哥德式，但工程因為西班牙內戰而延宕。復工後，為了與對面的馬德里王宮外觀協調，建築師大膽將外觀改為灰白色的新古典主義風格，這在傳統教堂建築中相當罕見。參觀時，您可以特別關注以下幾點：\n\n1. 普普風天花板：內部保留了新哥德式的結構，但裝飾卻極具現代感。特別是主祭壇上方的天花板，由現代藝術家繪製了色彩鮮豔大膽的幾何圖案，與傳統教堂的陰暗嚴肅截然不同。\n2. 皇家婚禮地：它是世界上最年輕的主教座堂之一，也是2004年現任西班牙國王費利佩六世與萊蒂西亞王后舉行世紀婚禮的地點，這讓教堂聲名大噪。\n3. 地下室 (Crypt)：不要錯過從旁邊獨立入口進入的地下室，那裡有超過400根風格各異的柱子，空間壯闊且莊嚴，是許多馬德里貴族的安息地。',
                            hashtags: ['catedraldelaalmudena', 'almudenacathedral', 'catedralalmudena', 'madridcathedral', 'madridturismo'],
                            tips: ['登頂參觀博物館需購票，視野獨特。', '地下室(Crypt)有獨立入口，超過400根不同柱子，非常壯觀。']
                        },
                        {
                            name: '普拉多博物館 (Museo del Prado)',
                            info: '10:00 - 20:00 | 閉館前2小時免費',
                            history: '與羅浮宮、大英博物館並列世界三大美術館，普拉多是西班牙藝術靈魂的棲息地。若只有兩小時，請直奔以下5大鎮館之寶：\n\n1. 委拉斯開茲《宮女》(Las Meninas)：被譽為「世界三大名畫」。畫家把自己也畫進其中，透過鏡子反射巧妙將站在畫作前的「國王與王后」（也就是現在觀眾的位置）融入畫面，打破了虛實的界線。\n2. 哥雅《農神吞噬其子》：哥雅晚年失聰且對人類社會絕望，在自家牆壁畫下著名的「黑色繪畫」系列。此畫用極陰鬱恐怖的筆觸，展現神明為保住權力而吃掉親生骨肉的瘋狂與殘酷。\n3. 哥雅《裸體的瑪哈》與《穿衣的瑪哈》：藝術史上首批不以神話為藉口、直接描繪凡人裸體的畫作，哥雅還因此被宗教裁判所傳喚審問。\n4. 波希《人間樂園》(The Garden of Earthly Delights)：這幅三聯畫是早期超現實主義的神作。從左至右分別描繪伊甸園、充滿荒誕慾望的現世，以及恐怖獵奇的地獄，畫中充滿腦洞大開的怪物與細節。\n5. 埃爾·格雷考《胸前放手騎士》：修長變形的人物比例與蒼白膚色是他的招牌，畫作完美捕捉了16世紀西班牙貴族那種虔誠、驕傲又帶點憂鬱的氣質。',
                            hashtags: ['museodelprado', 'pradomuseum', 'artemadrid', 'goya', 'velazquez'],
                            tips: ['免費時段建議提早45分鐘排隊。', '館內嚴禁拍照。', '建議先下載參觀路線圖鎖定重點。']
                        }
                    ],
                    hiddenGems: [
                        { name: '麗池公園 (El Retiro)', desc: '馬德里的綠肺，水晶宮是必去夢幻景點。', query: 'El Retiro Park Madrid' },
                        { name: '聖米格爾市場', desc: '最美鋼鐵玻璃結構市場，適合吃Tapas。', query: 'Mercado de San Miguel Madrid' },
                        { name: '德波神廟', desc: '埃及贈送的古神廟，看夕陽最美。', query: 'Templo de Debod Madrid' },
                        { name: '西貝萊斯廣場', desc: '皇馬慶祝地標，背景郵政大樓極美。', query: 'Plaza de Cibeles Madrid' },
                        { name: '索菲亞王后藝術中心', desc: '收藏畢卡索《格爾尼卡》真跡。', query: 'Museo Reina Sofía Madrid' }
                    ],
                    shopping: [
                        { name: 'Casa de Diego', type: '經典工藝', desc: '百年老店，手工扇子與陽傘是高級紀念品。', query: 'Casa de Diego Puerta del Sol 12' },
                        { name: 'El Moderno', type: '設計選物', desc: '位於瑪拉薩尼亞區，精選創意設計小物，非常有品味。', query: 'El Moderno Concept Store Corredera Baja de San Pablo 29' },
                        { name: 'La Violeta', type: '伴手禮', desc: '經典紫色紫羅蘭糖，包裝精美。', query: 'La Violeta Plaza de Canalejas 6' },
                        { name: 'LOEWE Gran Vía', type: '精品/建築', desc: '皇室愛用品牌旗艦店，建築如博物館般優雅。', query: 'LOEWE Gran Vía 8' },
                        { name: 'Castañer', type: '鞋履', desc: '草編鞋始祖，款式齊全。', query: 'Castañer Claudio Coello 51' }
                    ],
                    souvenirs: ['紫羅蘭糖', '手工扇子', '皇家馬德里球衣', '杜隆糖', 'Loewe 香水'],
                    food: [
                        { name: 'Casa Dani', category: 'Tapas', price: '15-25', info: '市場內號稱全馬德里最好吃的馬鈴薯烘蛋。', query: 'Casa Dani Mercado de la Paz' },
                        { name: 'Chocolatería San Ginés', category: '甜點', price: '5-10', info: '24小時百年老店，必點熱巧克力沾油條。', query: 'Chocolatería San Ginés Pasadizo de San Ginés' },
                        { name: 'Sobrino de Botín', category: '正餐', price: '30-50', info: '金氏紀錄最古老餐廳，烤乳豬必吃。', query: 'Restaurante Botin Madrid' },
                        { name: 'Museo del Jamón', category: '小吃', price: '5-15', info: '火腿博物館，站著吃可頌夾心超便宜。', query: 'Museo del Jamón Calle Mayor' },
                        { name: 'Mercado de San Miguel', category: 'Tapas', price: '15-30', info: '最美市場，各式精緻Tapas。', query: 'Mercado de San Miguel Madrid' },
                        { name: 'La Campana', category: '小吃', price: '5-10', info: '主廣場旁必吃炸魷魚圈三明治。', query: 'La Campana Madrid Plaza Mayor' },
                        { name: 'Casa Labra', category: 'Tapas', price: '10-20', info: '太陽門旁百年老店，必點炸鱈魚球。', query: 'Casa Labra Madrid' },
                        { name: 'Takos Al Pastor', category: '小吃', price: '5-10', info: '超人氣平價塔可，翻桌快。', query: 'Takos Al Pastor Madrid' },
                        { name: 'La Mallorquina', category: '甜點', price: '2-5', info: '太陽門旁百年糕餅店，必吃拿破崙派。', query: 'La Mallorquina Madrid' }
                    ]
                },
                seville: {
                    name: '塞維利亞',
                    attractions: [
                        {
                            name: '西班牙廣場 (Plaza de España)',
                            info: '全天開放 | 建議下午接近日落時前往',
                            history: '這座為了1929年伊比利美洲博覽會而建的廣場，是塞維利亞最浪漫的名片，也是電影《星際大戰二部曲：複製人全面進攻》中那卜星的取景地。建築師阿尼巴爾將文藝復興風格與摩爾復興風格完美結合，打造出這座視覺震撼的建築。來到這裡，請放慢腳步欣賞：\n\n1. 58幅省份瓷磚畫：廣場底部沿著護城河鑲嵌著精美的彩色瓷磚壁畫（Azulejos），每一幅都代表西班牙的一個省份，並按字母順序排列，描繪著當地的歷史場景與地圖，尋找特定省份是遊客最愛的活動。\n2. 半圓形護城河與橋樑：四座橋樑象徵著西班牙古老的四個王國（卡斯提亞、萊昂、亞拉岡、納瓦拉），您可以租一艘小船在河上划行，非常愜意。\n3. 街頭佛朗明哥：在廣場的迴廊下或陰涼處，幾乎每天都有高水準的街頭藝人表演佛朗明哥舞，舞步激昂、歌聲滄桑，是體驗安達魯西亞靈魂的絕佳時刻。',
                            hashtags: ['plazadeespañasevilla', 'sevilla', 'visitseville', 'plazadeespaña', 'andalucia'],
                            tips: ['可租小船划行，非常浪漫但夏天很曬。', '尋找自己出生年份或特定省份瓷磚畫合照。', '公廁較少，建議在鄰近公園解決。']
                        },
                        {
                            name: '黃金塔 (Torre del Oro)',
                            info: '09:30 - 18:45 | 週一免費',
                            history: '這座十二邊形的軍事瞭望塔矗立在瓜達基維爾河畔，建於13世紀的穆瓦希德王朝（摩爾人統治時期）。它曾是塞維利亞防禦系統的關鍵：古時防禦者會用一條巨大的鐵鍊橫跨河面，連接對岸的另一座塔（現已不存在），以此封鎖河道，防止敵船入侵。關於「黃金塔」名稱的由來有許多傳說，有人說是因為大航海時代這裡曾儲存來自美洲的黃金，也有人說塔身曾貼滿金磚。但近期的修復研究證實，這金色光澤其實來自於其原始建築材料——灰泥、石灰與壓碎的稻草混合後，在強烈安達魯西亞陽光照射下產生的視覺效果。如今它是一座海軍博物館，展示了塞維利亞豐富的航海歷史，登頂可將河流與大教堂的美景盡收眼底。',
                            hashtags: ['torredeloro', 'guadalquivir', 'sevillespain', 'torredelorosevilla', 'goldentower'],
                            tips: ['週一免費但人多。', '從對岸貝蒂斯街拍攝可帶入河面倒影。', '旁邊是觀光船碼頭。']
                        },
                        {
                            name: '塞維利亞王宮 (Real Alcázar)',
                            info: '09:30 - 17:00 | 《冰與火之歌》拍攝地',
                            history: '這是歐洲最古老且仍由皇室使用的王宮，其歷史層疊如同千層派。它始建於10世紀的摩爾人城堡，後來經歷了基督教君主（尤其是殘酷者佩德羅一世）的擴建，完美融合了穆德哈爾(Mudejar)、哥德與文藝復興風格。參觀王宮，請特別留意以下奇景：\n\n1. 佩德羅一世宮的「少女中庭」：這裡展示了伊斯蘭工匠在基督徒統治下創造的奇蹟，繁複的石膏雕花如同蕾絲般覆蓋牆面，卻巧妙地混入了卡斯提亞王國的獅子與城堡徽章。\n2. 大使廳 (Hall of Ambassadors)：擁有一個令人屏息的木雕半圓形穹頂，象徵著宇宙星空，是王宮內最華麗的房間。\n3. 瑪麗亞·帕迪拉的浴室：位於地下的拱頂蓄水池，幽暗的光線與水面倒影營造出神秘的氛圍。\n4. 流水花園：這片廣大且充滿熱帶植物與噴泉的花園，正是《冰與火之歌：權力遊戲》中「多恩王國」的拍攝地。',
                            hashtags: ['realalcazarsevilla', 'alcazarofseville', 'gameofthroneslocation', 'mudejar', 'royalalcazar'],
                            tips: ['強烈建議提前官網訂票。', '週一閉館前一小時有免費時段(需搶票)。', '勿錯過花園中的「浴室」拍倒影。']
                        },
                        {
                            name: '塞維利亞主教堂',
                            info: '10:45 - 17:00 | 包含吉拉達塔登頂',
                            history: '「讓我們建一座大到讓後世見到的人都以為我們瘋了的教堂。」這就是這座世界最大哥德式教堂（世界第三大教堂）的建造宣言。它建於12世紀大清真寺的遺址上，為了展現天主教收復失地的勝利與塞維利亞在貿易上的財富。走進教堂，這三個重點絕對不能錯過：\n\n1. 哥倫布的靈柩：這位偉大航海家的遺骨歷經多次搬遷，最終安息於此。他的靈柩由四位穿著華麗戰袍的國王雕像抬起，分別象徵當時統治西班牙的四個古老王國：卡斯提亞、萊昂、納瓦拉與亞拉岡。\n2. 主祭壇：這是世界上最大的木雕祭壇，使用了來自美洲的大量黃金裝飾，雕刻了耶穌生平的 44 個場景，金碧輝煌令人目眩。\n3. 吉拉達塔 (Giralda)：這座高達37層樓的鐘塔原是清真寺的宣禮塔。特別的是，它內部沒有樓梯，而是35層寬闊的斜坡，這是為了方便古代宣禮員騎馬登塔喚拜。登塔過程相對輕鬆，塔頂是俯瞰橘子庭院與白色舊城的最佳位置。',
                            hashtags: ['catedraldesevilla', 'giralda', 'sevillecathedral', 'giraldatower', 'catedraldesevilla⛪️'],
                            tips: ['買門票含薩爾瓦多教堂免費入場。', '可先去薩爾瓦多教堂買聯票免排隊。', '登塔全是斜坡，夏天請帶水。']
                        },
                        {
                            name: '都市陽傘 (Metropol Parasol)',
                            info: '10:00 - 23:00 | 俗稱「大蘑菇」',
                            history: '這座被當地人戲稱為「大蘑菇 (Las Setas)」的建築，是號稱世界最大的木造結構體，也是塞維利亞現代與古老共存的最佳象徵。這裡原本計劃興建一座大型地下停車場，卻在挖掘過程中意外發現了珍貴的古羅馬與摩爾人遺跡，工程因此停擺多年。最終，德國建築師尤爾根·邁耶設計了這個大膽的方案：地下層完好保留遺跡作為博物館 (Antiquarium)，地面層作為傳統市場與市民廣場，而上方巨大的波浪狀木造網格雲蓋則為這座炎熱的城市提供了大片遮陽空間。頂部的蜿蜒步道提供了360度無死角的視野。強烈建議在黃昏時分前往，您可以看著夕陽將古老的教堂尖塔與現代的白色網格染成金黃色，入夜後還會點亮霓虹燈光，畫面極具科幻感。',
                            hashtags: ['setasdesevilla', 'metropolparasol', 'las_setas', 'sevilleview', 'setassevilla'],
                            tips: ['門票含頂樓酒吧飲料券，記得兌換。', '最佳時間是日落前30分鐘。', '憑門票可免費參觀地下室羅馬遺跡。']
                        }
                    ],
                    hiddenGems: [
                        { name: '特里亞納區 (Triana)', desc: '河對岸陶器與佛朗明哥發源地。', query: 'Triana District Seville' },
                        { name: '彼拉多官邸', desc: '「小王宮」，磁磚裝飾極美，遊客較少。', query: 'Casa de Pilatos Seville' },
                        { name: '聖十字區', desc: '猶太舊街區，巷弄曲折適合迷路探險。', query: 'Barrio de Santa Cruz Seville' },
                        { name: '瑪麗亞路易莎公園', desc: '西班牙廣場旁的巨大綠地。', query: 'Parque de María Luisa Seville' },
                        { name: '印度群島檔案館', desc: '存放航海時代珍貴手稿的世界遺產。', query: 'Archivo de Indias Seville' }
                    ],
                    shopping: [
                        { name: 'Cerámica RUIZ', type: '陶瓷', desc: '特里亞納區老字號，購買傳統彩繪陶瓷最佳地點。', query: 'Cerámica Ruiz Calle San Jorge 27' },
                        { name: 'Mariquita Trasquilá', type: '時尚/女裝', desc: '時下最紅平價禮服與設計選物，當地女生超愛。', query: 'Mariquita Trasquilá Sevilla Calle Cuna 14' },
                        { name: 'Ines Rosales', type: '伴手禮', desc: '百年橄欖油薄餅，超市買最便宜。', query: 'Mercadona Plaza de Armas' },
                        { name: 'Agua de Sevilla', type: '香氛', desc: '苦橙花基底香水，請認明 Calle Tetuán 旗艦店。', query: 'Perfumerías Aromas Calle Tetuán 5' }
                    ],
                    souvenirs: ['彩繪陶瓷', '橄欖油薄餅', '苦橙花香水', '佛朗明哥舞裙/扇子'],
                    food: [
                        { name: 'La Brunilda', category: 'Tapas', price: '15-25', info: '排隊網紅店，創意Tapas，必點鴨肉燉飯。', query: 'La Brunilda Tapas Seville' },
                        { name: 'Eslava', category: 'Tapas', price: '15-25', info: '獲獎名店，必點雪茄捲和低溫慢煮蛋。', query: 'Espacio Eslava Seville' },
                        { name: 'El Rinconcillo', category: '正餐', price: '20-35', info: '1670年開業最古老酒吧，菠菜鷹嘴豆是招牌。', query: 'El Rinconcillo Seville' },
                        { name: 'Bodega Santa Cruz', category: '小吃', price: '10-20', info: '教堂旁柱子酒吧，站著吃超親民。', query: 'Bodega Santa Cruz Las Columnas' },
                        { name: 'Confitería La Campana', category: '甜點', price: '5-10', info: '百年甜點店，適合早餐下午茶。', query: 'Confitería La Campana Seville' },
                        { name: 'Bar Alfalfa', category: 'Tapas', price: '10-20', info: '當地人聚集小酒館，Bruschetta口味多。', query: 'Bar Alfalfa Seville' },
                        { name: 'Freiduría La Isla', category: '海鮮', price: '15-25', info: '專賣安達魯西亞炸魚老店。', query: 'Freiduría La Isla Seville' },
                        { name: 'Petit Comité', category: '正餐', price: '25-40', info: '精緻法式融合菜，適合約會。', query: 'Petit Comité Seville' }
                    ]
                },
                granada: {
                    name: '格拉納達',
                    attractions: [
                        {
                            name: '阿爾罕布拉宮 (Alhambra)',
                            info: '08:30 - 20:00 | 需提前3個月搶票',
                            history: '這座「紅色城堡」不只是宮殿，它是摩爾人對「人間天堂」的具體實踐，也是伊斯蘭建築的巔峰。參觀重點在「納斯里德宮 (Nasrid Palaces)」，這裡隱藏著幾個令人驚嘆的細節：\n\n1. 桃金孃中庭 (Court of the Myrtles)：靜止的水池完美倒映著科馬雷斯塔，這種設計不僅帶來清涼，更象徵著蘇丹權力的平靜與永恆。\n2. 獅子庭院 (Court of the Lions)：12隻石獅支撐著噴泉，象徵黃道十二宮或時間的流逝。其精妙的地下水力系統讓水流在炎熱夏天仍能保持流動與清涼，是中世紀工程的奇蹟。\n3. 鐘乳石穹頂：在「兩姊妹廳」和「阿本塞拉赫斯廳」抬頭看，那由成千上萬個石膏幾何切面組成的蜂巢狀穹頂（Muqarnas），隨著光線變化產生奇妙的光影，象徵著宇宙的浩瀚與真主的複雜性。\n4. 牆上的詩句：牆上如蕾絲般的雕刻不僅是裝飾，很多都是阿拉伯文的詩句，最常見的一句是：「唯有真主是勝利者」。這座宮殿的每一處都在訴說著那個曾經輝煌、最終在1492年被天主教雙王收復的王朝故事。',
                            hashtags: ['alhambra', 'alhambradegranada', 'granada', 'nasridpalaces', 'generalife'],
                            tips: ['門票時間是納斯里德宮入場時間，遲到會被拒。', '務必帶護照正本查驗。', '園區極大，建議預留4-5小時。']
                        },
                        {
                            name: 'La Alcaicería (阿拉伯絲綢市集)',
                            info: '10:00 - 21:00 | 就在大教堂旁',
                            history: '這裡曾是摩爾時期格拉納達的大市集（Grand Bazaar），專門交易絲綢、香料與貴重物品，全盛時期擁有超過200家店鋪，並有嚴格的夜間門禁以防盜竊。雖然原本的古老建築在19世紀的一場火柴店大火中付之一炬，但重建後的市集依然刻意保留了濃厚的北非風情。走進這裡，您會發現巷弄狹窄到只能容兩人擦肩而過，這是傳統阿拉伯市集的設計，目的是為了遮擋安達魯西亞毒辣的陽光與防風沙。現在街道兩旁掛滿了色彩繽紛的法蒂瑪之手飾品（象徵保佑與避邪）、格拉納達特有的鑲嵌木工藝品（Taracea）以及彩繪陶碗。雖然現在多販售觀光紀念品，但在這裡迷路、聞著皮革與香料的味道，依然能讓你瞬間穿越到摩洛哥的馬拉喀什。',
                            hashtags: ['alcaiceria', 'granadasouk', 'granadamarket', 'visitgranada', 'granadashopping'],
                            tips: ['遇推銷若無興趣請堅定拒絕。', '買紀念品好地方，記得適度殺價。', '巷弄狹窄注意財物。']
                        },
                        {
                            name: '阿爾拜辛老城區 (Albayzín)',
                            info: '全天開放 | 建議穿好走的鞋',
                            history: '與阿爾罕布拉宮隔著達羅河谷對望的這片白色山城，是格拉納達最古老的街區，也是1492年摩爾人交出城市後最後的避難所。這裡被完整保留了中世紀的街道佈局，漫步其中，您可以觀察到幾個特色：\n\n1. 迷宮般的街道：狹窄、蜿蜒且常遇到死胡同，這種設計不僅能阻擋強烈的陽光，更是為了防禦外敵，讓不熟悉地形的基督教騎士在巷弄中迷失方向。\n2. 白牆與庭院：白色的牆面是為了反射陽光降溫，而許多高牆背後隱藏著被稱為「Cármenes」的傳統庭院，裡面種滿了葡萄藤、茉莉花與柑橘樹，並設有噴泉，是典型的伊斯蘭封閉式私密花園。\n3. 水池網絡：街角常見名為「Aljibes」的古老蓄水池，它們曾是這個社區生命線的遺跡。在這裡散步不需要地圖，每一個轉角都可能遇見驚喜，或許是一間隱密的摩爾式茶館，或許是突然開闊的視野，能眺望對面雄偉的紅色城堡。',
                            hashtags: ['albayzin', 'albaicin', 'granadaspain', 'barrioalbaicin', 'andalucia'],
                            tips: ['全是鵝卵石坡路，勿穿高跟鞋或拖行李。', '建議搭巴士上山再走下來。', '晚上建議走大路或結伴。']
                        },
                        {
                            name: '聖尼古拉斯觀景台',
                            info: '全天開放 | 日落前1小時抵達',
                            history: '前美國總統柯林頓曾在參觀後，將這裡譽為「擁有世界最美夕陽的地方」。這絕對不是誇飾，站在這個位於阿爾拜辛區最高處的觀景台，你可以獲得一張完美的明信片視角：隔著深邃的達羅河谷，平視對面宏偉的阿爾罕布拉宮全景，而宮殿背後，則是西班牙本土最高峰——終年積雪的內華達山脈 (Sierra Nevada)。最魔幻的時刻發生在夕陽西下時，紅色的宮殿牆面、白色的雪山與逐漸轉暗的天空，會被夕陽染成一片層次豐富的金紅色。這裡的氛圍同樣迷人，小小的廣場上總是坐滿了來自世界各地的遊客，當地的吉普賽藝人會坐在矮牆上彈奏著吉他，唱著深情且帶著滄桑的佛朗明哥歌曲。伴隨著熱烈的掌聲與夕陽，這是來到格拉納達最浪漫、最觸動人心的體驗。',
                            hashtags: ['miradordesannicolas', 'alhambravlew', 'sunsetgranada', 'flamencogranada', 'miradorsannicolas'],
                            tips: ['日落前半小時海景第一排就會被佔滿。', '小偷非常多，拍照請留意包包。', '旁邊清真寺花園也可免費進入，視野一樣好。']
                        },
                        {
                            name: '格拉納達主教座堂',
                            info: '10:00 - 18:15',
                            history: '這座宏偉的教堂在西班牙歷史上具有無與倫比的政治與宗教意義。它建於原大清真寺的遺址之上，象徵著天主教雙王（伊莎貝拉女王與斐迪南國王）於1492年成功收復格拉納達，完成了長達近八百年的「收復失地運動 (Reconquista)」。在建築風格上，它是西班牙第一座文藝復興式教堂，與歐洲常見的陰暗哥德式教堂不同，內部空間極為寬敞明亮，以純白色為主色調，巨大的科林斯式柱支撐著高聳的圓頂，給人一種神聖而純淨的壓迫感。參觀的重頭戲是緊鄰大教堂的「皇家禮拜堂 (Capilla Real)」，這裡需要另外購票進入。這個禮拜堂是雙王為自己指定的陵寢，裡面安葬著伊莎貝拉女王、斐迪南國王，以及他們的繼承者「瘋女胡安娜」與丈夫。對於西班牙人來說，這裡是國家的原點，見證了現代西班牙統一的開端。',
                            hashtags: ['catedraldegranada', 'granadacathedral', 'capillareal', 'granadacentro', 'renacimientoespañol'],
                            tips: ['皇家禮拜堂入口分開，需另外購票。', '門票含語音導覽。', '周圍是香料市集可順道逛。']
                        }
                    ],
                    hiddenGems: [
                        { name: '達羅河畔', desc: '世界最浪漫散步街道，沿溪仰望城堡。', query: 'Carrera del Darro Granada' },
                        { name: '薩克羅蒙特', desc: '吉普賽洞穴屋區，欣賞洞穴佛朗明哥。', query: 'Sacromonte District Granada' },
                        { name: '卡圖哈修道院', desc: '巴洛克極致，內部裝飾繁複華麗。', query: 'Cartuja Monastery Granada' },
                        { name: '聖熱羅尼莫修道院', desc: '格拉納達第一座天主教修道院，安靜莊嚴。', query: 'Monasterio de San Jerónimo Granada' }
                    ],
                    shopping: [
                        { name: 'Artesanía El Suspiro', type: '工藝品', desc: 'Alcaicería內精緻小店，販售高品質鑲嵌木盒。', query: 'Artesanía El Suspiro Granada' },
                        { name: 'Herbolario El Nazarí', type: '香料/茶葉', desc: '茶街上買道地混合茶或番紅花推薦。', query: 'Herbolario El Nazarí Calle Calderería Nueva 13' },
                        { name: 'Fajalauza Ceramics', type: '陶瓷', desc: '傳統藍綠彩繪陶瓷，推薦 Cerámica Los Arrayanes。', query: 'Cerámica Los Arrayanes Cuesta de Gomérez 4' }
                    ],
                    souvenirs: ['鑲嵌木工藝品', '阿拉伯香料茶葉', '法蒂瑪之手飾品', '石榴造型紀念品'],
                    food: [
                        { name: 'El Mirador de Tato', category: '景觀餐廳', price: '25-40', info: '阿爾拜辛區絕佳視野，精緻安達魯西亞料理。', query: 'El Mirador de Tato Granada' },
                        { name: 'Los Diamantes', category: '海鮮', price: '15-25', info: '傳奇炸海鮮，點飲料送Tapas，炸小魚必點。', query: 'Bar Los Diamantes Plaza Nueva' },
                        { name: 'Bodegas Castañeda', category: 'Tapas', price: '15-25', info: '懷舊風情傳統酒館，必點冷盤拼盤。', query: 'Bodegas Castañeda Granada' },
                        { name: 'Heladería Los Italianos', category: '甜點', price: '3-6', info: '當地最愛冰淇淋，必點Cassata。', query: 'Heladería Los Italianos Granada' },
                        { name: 'Pionono', category: '甜點', price: '2-4', info: '特產小蛋糕，推薦 Pastelería Ysla。', query: 'Pastelería Ysla Granada' },
                        { name: 'Restaurante Mirador de Morayma', category: '正餐', price: '30-50', info: '看著阿爾罕布拉宮用餐，非常浪漫。', query: 'Mirador de Morayma' },
                        { name: 'Taberna La Tana', category: 'Tapas', price: '15-25', info: '葡萄酒選品棒，老闆娘熱情。', query: 'Taberna La Tana Granada' },
                        { name: 'Entrebrasas', category: '牛排', price: '20-35', info: '肉食者必來，送的Tapas常是現烤肉塊。', query: 'Entrebrasas Granada' },
                        { name: 'Café 4 Gatos', category: '早餐', price: '5-10', info: '文青咖啡店，有阿爾罕布拉宮景觀。', query: 'Café 4 Gatos Granada' }
                    ]
                },
                barcelona: {
                    name: '巴塞隆納',
                    attractions: [
                        {
                            name: '聖家堂 (Sagrada Família)',
                            info: '09:00 - 18:00 | 必買導覽，登塔需預約',
                            history: '這是鬼才建築師高第傾盡畢生心血的遺作，也是世界上唯一一座尚未完工就被列入世界遺產的建築。自1882年動工至今，它像是有生命般地生長著，預計在2026年（高第逝世百週年）完工。教堂的三個立面訴說著不同的故事：「誕生立面」由高第親自監督，繁複的雕刻展現了耶穌誕生的喜悅與大自然的生命力，仔細看柱子底部，分別由海龜與陸龜支撐，象徵海洋與陸地；「受難立面」則由雕刻家蘇比拉克斯接手，線條剛硬、表情痛苦，強烈展現耶穌受難的悲劇。走進教堂內部，你將進入一座「光之森林」。高第以大自然為師，樹狀的石柱分支支撐著高達數十公尺的拱頂。最令人震撼的是光影：陽光透過色彩繽紛的玻璃灑下，東面的藍綠色象徵著新生的晨光與希望，西面的紅橘色則象徵著夕陽餘暉與受難。置身其中，你會感受到一種超越宗教的、純粹的神聖與平靜。',
                            hashtags: ['sagradafamilia', 'gaudi', 'sagradafamiliabarcelona', 'barcelonagram', 'antonigaudi'],
                            tips: ['登塔建議選誕生立面。', '最佳光影：上午拍誕生面，下午拍受難面。', '服裝嚴格規定需遮肩膝。']
                        },
                        {
                            name: '奎爾公園 (Park Güell)',
                            info: '09:30 - 17:30 | 需購票入場',
                            history: '這裡原本是一個極具前瞻性的高級住宅區開發案。1900年，富商奎爾伯爵委託高第在光禿禿的「禿頭山」上打造一個結合英式花園與現代設施的社區，預計建造60棟別墅。然而，因為交通不便且概念過於前衛，最終只賣出2戶（買家還是高第自己和他的律師）。開發失敗後，這裡意外成為了充滿童話色彩的公園。高第在這裡完美展現了他對自然仿生學的崇敬，他利用原本的地形地貌，設計出如同波浪般的長椅、模仿樹幹傾斜的石柱廊，以及糖果屋般的門房。有兩個必看亮點：首先是「百柱廳」，天花板上有美麗的馬賽克圓盤，這其實是一個巨大的集水系統，用來收集雨水並過濾到地下的儲水槽；其次是入口處那隻標誌性的彩色大蜥蜴（El Drac），高第使用廢棄的瓷磚碎塊拼貼而成（被稱為 Trencadís 碎瓷拼貼技術），它不僅是公園的守護神，更是巴塞隆納最受歡迎的城市圖騰，象徵著加泰羅尼亞傳說中的煉金術與火。',
                            hashtags: ['parkguell', 'parqueguell', 'gaudi', 'barcelona', 'parkguellbarcelona'],
                            tips: ['建議搭24號公車直達側門一路下坡。', '波浪長椅和大蜥蜴在收費區，需購票。', '遲到半小時票券失效。']
                        },
                        {
                            name: '米拉之家 (Casa Milà)',
                            info: '09:00 - 20:30 | 俗稱「採石場」',
                            history: '這棟建築因其波浪狀的粗糙石材外觀，在建造當時被保守的市民戲稱為「採石場 (La Pedrera)」，它也是高第最後一個私人住宅作品。整棟建築從裡到外完全沒有一條直線，完美展現了高第的名言：「直線屬於人類，曲線屬於上帝」。在建築工法上，米拉之家極具革命性：它採用了當時創新的鋼骨結構與柱子支撐，使得牆面不再需要承重。這意味著內部隔間可以自由改變，且外牆的窗戶可以開得無限大，帶來極佳的採光。參觀的最高潮在屋頂，高第將原本醜陋的煙囪與通風塔，設計成了帶著頭盔的中世紀騎士或是外星戰士的模樣。這些守護者孤獨地佇立在高低起伏的屋頂上，守望著這座城市。米拉之家不僅是一棟公寓，更是一件矗立在格拉西亞大道上的巨大抽象雕塑。',
                            hashtags: ['casamila', 'lapedrera', 'gaudi', 'barcelonaarchitecture', 'passeigdegracia'],
                            tips: ['建議買日夜套票看屋頂燈光秀。', '重點在屋頂和閣樓鯨魚骨架。', '出口紀念品店品質高。']
                        },
                        {
                            name: '巴特略之家 (Casa Batlló)',
                            info: '09:00 - 20:00 | AR導覽超棒',
                            history: '如果說米拉之家是山，那巴特略之家就是海與神話。這是一座講述加泰羅尼亞守護神「聖喬治屠龍」傳說的建築。高第受紡織業大亨委託改造這棟舊公寓，將它變成了一本立體的童話書。從外觀看，屋頂拱起的彩色馬賽克如同巨龍的脊背，左側聳立的十字架塔象徵著聖喬治插在龍背上的聖劍，而那些骨骼造型的陽台與柱子，則像是被惡龍吃掉的受害者的骸骨（也有一說是威尼斯面具）。走進室內，高第運用了大量的藍色瓷磚與波浪形玻璃，顏色由下往上逐漸變深，讓整棟房子的天井如同海洋般深邃，隨著光線變化彷彿置身海底。內部的門把、扶手和窗戶都完全符合人體工學，沒有任何尖銳的稜角。2021年重新設計的沈浸式 AR 導覽體驗非常出色，透過平板螢幕，您能看到海龜在房間游動、蘑菇壁爐生火，讓人徹底潛入高第那瘋狂又天才的腦海中。',
                            hashtags: ['casabatllo', 'gaudi', 'modernisme', 'barcelona', 'casabatlló'],
                            tips: ['門票雖貴但AR導覽值得。', '屋頂空間小，建議開門就衝。', '樓梯間藍色天井必拍。']
                        },
                        {
                            name: '聖保羅醫院',
                            info: '09:30 - 17:00 | 最美的醫院',
                            history: '這座醫院由高第的老師——加泰羅尼亞現代主義大師多明尼克 (Lluís Domènech i Montaner) 所設計，被聯合國教科文組織列為世界遺產，更被譽為「世界上最美的醫院」。在20世紀初，多明尼克提出了一個前衛的醫療理念：「藝術與自然可以療癒靈魂」。他認為病人不應該被關在冰冷、擁擠的白色病房中，美麗的環境與新鮮空氣有助於加速康復。因此，他設計了一座如花園城市般的醫院。廣大的園區內有27棟紅磚建築，每棟病房樓都獨立分開以防止傳染，地下則有通道連接方便運送病患。地面上種滿了具有療癒香氣的薰衣草、橘子樹與藥草。建築外觀大量使用了色彩繽紛的馬賽克拼貼、彩繪玻璃與精美的雕塑。這座建築證明了醫院的功能性與極致的藝術性可以完美共存，是巴塞隆納不可錯過的隱藏版瑰寶。',
                            hashtags: ['santpaurecintemodernista', 'hospitalsantpau', 'santpau', 'barcelona', 'modernismecatala'],
                            tips: ['離聖家堂走路15分鐘。', '遊客較少，適合拍網美照。', '展覽館粉紅圓頂必拍。']
                        },
                        {
                            name: '加泰羅尼亞音樂宮',
                            info: '10:00 - 15:30 | 建議參加導覽或看表演',
                            history: '如果說聖家堂是高第的代表作，那麼這座音樂宮就是建築大師多明尼克 (Lluís Domènech i Montaner) 的極致炫技之作。它是目前世界上唯一一座被列為世界文化遺產的音樂廳。這座建築建於1905年，是為了當地的平民合唱團 (Orfeó Català) 而建。在設計上，多明尼克大膽使用了當時最新的玻璃帷幕與鋼鐵結構技術，讓自然光可以完全照亮整個表演廳。最令人屏息的絕對是表演廳正上方的巨大倒吊彩色玻璃穹頂：中心金黃色的部分象徵太陽，周圍漸層的藍色象徵天空與女性的合唱聲，整個穹頂彷彿一滴巨大的金色水滴，在重力的牽引下即將滴落。舞台的背景同樣精彩，牆面上有18位半立體的謬思女神雕像，她們手持不同的樂器，上半身躍出牆面，下半身則是平面的馬賽克，彷彿隨時會走下舞台演奏。這裡將花卉雕塑、光影與音樂完美結合，是一座名副其實的藝術聖殿。',
                            hashtags: ['palaudelamusica', 'palaumusicacatalana', 'barcelona', 'modernisme', 'unesco'],
                            tips: ['可買便宜表演票入場感受音響。', '中文導覽需特定時間。', '一樓咖啡廳免費進入，紅磚拱門很美。']
                        },
                        {
                            name: '畢卡索美術館',
                            info: '10:00 - 19:00 | 週四下午免費(需預約)',
                            history: '這座美術館的獨特之處，在於它並非位於現代建築內，而是巧妙地坐落於舊城區（Born區）五座相連的優美中世紀貴族宅邸中。畢卡索與巴塞隆納有著極為深厚的情感連結，這裡是他度過青春期與藝術成形期的地方。館內收藏了超過4,000件畢卡索早期的作品，尤其是他著名的「藍色時期」畫作。畢卡索曾說：「我14歲就能畫得像拉斐爾一樣好，但我花了一輩子學習像孩子一樣畫畫。」在這裡，您可以沿著時間軸，清晰地看到這位大師如何從一位古典寫實技巧無懈可擊的天才少年，逐漸受到各種風格影響，最終打破規則，走向立體派與抽象藝術的演變過程。館內的鎮館之寶，是畢卡索在晚年對委拉斯開茲的名畫《宮女》進行解構重繪的58幅系列作，透過這些畫作，你可以直接與大師的創作邏輯對話。',
                            hashtags: ['museupicasso', 'picassomuseum', 'pablopicasso', 'barcelona', 'elborn'],
                            tips: ['免費時段需提前4天搶票。', '僅庭院可拍照。', '參觀完可逛Born區小店。']
                        },
                        {
                            name: '哥倫布紀念碑',
                            info: '08:30 - 14:30 | 位於蘭布拉大道盡頭',
                            history: '這座高達60公尺的青銅與鑄鐵紀念碑，建立於1888年巴塞隆納萬國博覽會期間。它矗立在蘭布拉大道的盡頭、舊港口旁，具有重要的歷史意義：因為當年哥倫布完成第一次美洲航海歸來時，正是在巴塞隆納向贊助他的伊莎貝拉女王與斐迪南國王匯報發現「新大陸」的偉大事蹟。紀念碑頂端的哥倫布雕像左手拿著航海圖，右手堅定地指向遠方。有趣的是，他手指的方向實際上是指向阿爾及利亞（非洲）而非美洲。這是因為如果指向美洲，雕像將會指向內陸，為了美觀與航海的象徵意義，設計師選擇讓他指向廣闊的地中海。遊客可以搭乘塔身內部極為狹小的電梯登上頂端的環形觀景台，雖然空間僅能容納幾個人，但能360度俯瞰舊港口的遊艇、蘭布拉大道的人流以及整座城市的景色。',
                            hashtags: ['monumentacolom', 'columbusmonument', 'barcelona', 'ramblas', 'portvell'],
                            tips: ['電梯非常狹小。', '頂樓視野無敵。', '底部獅子雕像遊客愛拍。']
                        },
                        {
                            name: '巴塞羅那主教座堂',
                            info: '10:30 - 18:30 | 哥德區心臟',
                            history: '雖然聖家堂名氣極大，但這座位於哥德區心臟地帶的正統哥德式建築，才是巴塞隆納教區真正的主教座堂。教堂始建於13世紀，工程斷斷續續進行了數百年，直到20世紀初才完成了令人驚豔的新哥德式正立面。與高第建築充滿曲線與自然元素的風格截然不同，這裡充滿了尖塔、飛扶壁、怪獸出水口與嚴肅的幾何線條。教堂供奉著巴塞隆納的守護神——聖歐拉利亞 (Saint Eulalia)。最特別的景觀隱藏在教堂的迴廊中，那裡有一個種滿棕櫚樹的庭院，水池旁永遠養著13隻白鵝。據傳說，聖歐拉利亞在羅馬時期因拒絕放棄信仰，在13歲時殉教並遭受了13種酷刑，這13隻白鵝就是為了紀念她的純潔與犧牲的年齡。這裡是感受中世紀巴塞隆納莊嚴氛圍的最佳場所。',
                            hashtags: ['catedraldebarcelona', 'barcelonacathedral', 'barriogotic', 'gothicquarter', 'bcn'],
                            tips: ['服裝規定嚴格需遮肩膝。', '早晚有免費祈禱時段(限主殿)。', '必去迴廊看白鵝。']
                        },
                        {
                            name: '凱旋門 (Arc de Triomf)',
                            info: '全天開放 | 1888年博覽會入口',
                            history: '在歐洲，多數的凱旋門（如巴黎凱旋門）都是為了紀念戰爭的勝利而建，但巴塞隆納的這座凱旋門卻有著截然不同的和平意義。它是為了迎接1888年巴塞隆納世界博覽會而建造的迎賓大門。由建築師何塞·維拉塞卡設計，它沒有採用傳統的古典大理石，而是使用了溫暖的紅磚砌成，風格屬於獨特的新穆德哈爾風格（摩爾復興風格，帶有伊斯蘭建築的韻味）。門楣的正面雕刻著「巴塞隆納歡迎列國 (Barcelona rep les nacions)」的字樣，背面則是頒發獎章給參展者的浮雕。兩側的女性雕像分別象徵著工業、農業、商業與藝術，展現了這座城市在19世紀末積極擁抱世界、充滿自信與現代化的進程。穿過這座大門，您就會進入寬闊的林蔭大道與美麗的城堡公園。',
                            hashtags: ['arcdetriomf', 'arcdetriomfbarcelona', 'bcn', 'ciutadella', 'barcelona_turisme'],
                            tips: ['溜滑板熱點，氛圍活力。', '建議租單車騎進城堡公園。', '下午夕陽打在紅磚最美。']
                        },
                        {
                            name: 'Bunkers del Carmel',
                            info: '全天開放 | 360度免費觀景台',
                            history: '這個位於山丘上的廢墟，近年來成為巴塞隆納年輕人與社群上最熱門的夕陽觀景點。這裡原本是西班牙內戰時期（1937年），共和軍為了防禦法西斯空軍的猛烈轟炸而建立的高射炮陣地（防空洞）。內戰結束後，這裡的防禦設施被廢棄，在50至70年代間，一度被貧民和移民佔據，形成了被稱為「Los Cañones」的棚戶區（貧民窟）。直到1992年巴塞隆納舉辦奧運會前夕，政府才將居民安置並清理了此地。如今，這裡保留了殘破的混凝土結構，沒有門票、沒有圍欄，提供了一個粗獷且完全無遮蔽的 360 度城市全景。站在這裡，你可以同時將聖家堂的尖塔、子彈大樓（Agbar Tower）、蒙特惠奇山以及整片湛藍的地中海盡收眼底。',
                            hashtags: ['bunkersdelcarmel', 'barcelonaview', 'bunkers', 'sunsetbarcelona', 'bestviewbarcelona'],
                            tips: ['交通不便需爬坡。', '山上無商店廁所請自備。', '風大建議帶外套。']
                        },
                        {
                            name: 'El món neix en cada besada (吻牆)',
                            info: '全天開放 | 哥德區小巷',
                            history: '隱藏在哥德區靜謐的小廣場 (Plaça d\'Isidre Nonell) 內，這個名為「世界始於每一個吻」的馬賽克藝術裝置，總能給路過的旅人帶來驚喜。它是由加泰羅尼亞藝術家 Joan Fontcuberta 於2014年創作，目的是為了紀念1714年巴塞隆納在西班牙王位繼承戰爭中陷落（加泰羅尼亞民族日）的 300 週年。遠看，這是一幅由兩個巨大的鮮紅嘴唇正在熱情親吻的圖像。但當你走近仔細觀察，會發現這幅巨大的壁畫是由 4,000 張小型的照片磁磚拼貼而成的。這些照片是藝術家透過當地報紙向市民徵集而來，主題是「自由的時刻」。這座牆用一種極其溫柔的方式提醒著人們：比起戰爭與衝突，愛、生活與自由，才是這座城市乃至這個世界最珍貴的反抗力量。',
                            hashtags: ['elmónneixencadabesada', 'kissmural', 'barcelonakiss', 'gothicquarter', 'joanfontcuberta'],
                            tips: ['位置隱密需定位準確。', '熱門打卡點建議早去。', '記得近拍照片細節。']
                        }
                    ],
                    hiddenGems: [
                        { name: '布克利亞市場', desc: '色彩繽紛市場，喝果汁吃海鮮。', query: 'La Boqueria Market Barcelona' },
                        { name: '魔幻噴泉', desc: '週末燈光水舞秀震撼。', query: 'Magic Fountain of Montjuïc' },
                        { name: '文森之家', desc: '高第首個住宅作品，東方元素。', query: 'Casa Vicens Gaudí' },
                        { name: '巴塞羅內塔海灘', desc: '離市區最近海灘，吃海鮮飯。', query: 'Barceloneta Beach' }
                    ],
                    shopping: [
                        { name: 'ZARA', type: '時尚/旗艦店', desc: '加泰隆尼亞廣場旗艦店，建築宏偉貨全。', query: 'Zara Plaça de Catalunya 5' },
                        { name: 'LOEWE', type: '精品/建築', desc: '位於世界遺產獅子與桑樹之家內，逛店即欣賞藝術。', query: 'LOEWE Casa Lleó Morera Passeig de Gràcia 35' },
                        { name: 'Papirum', type: '古董文具', desc: '哥德區歷史名店，精美紙張羽毛筆，如哈利波特場景。', query: 'Papirum Baixada de la Llibreteria 2' },
                        { name: 'Caganer.com', type: '特色伴手禮', desc: '專賣排便人偶，象徵好運豐收，非常幽默。', query: 'Caganer.com Banys Nous 4' },
                        { name: 'Torrons Vicens', type: '甜點伴手禮', desc: '百年杜隆糖老店，推薦Petritxol老街分店。', query: 'Torrons Vicens Carrer de Petritxol 15' },
                        { name: 'La Chinata', type: '橄欖油', desc: '頂級橄欖油及護膚品，推薦Raval分店。', query: 'La Chinata Barcelona Raval' },
                        { name: 'FC Barcelona Store', type: '運動周邊', desc: '巴薩迷必去，格拉西亞大道旗艦店最大。', query: 'Barça Store Passeig de Gràcia 15' },
                        { name: 'Amatller Chocolate', type: '甜點', desc: '慕夏風格包裝巧克力，巴特略之家隔壁。', query: 'Chocolate Amatller Passeig de Gràcia 41' }
                    ],
                    souvenirs: ['杜隆糖', '排便人偶', '馬賽克蜥蜴紀念品', 'Cava 氣泡酒', '橄欖油護膚品'],
                    food: [
                        { name: 'Jon Cake', category: '甜點', price: '5-10', info: '社群爆紅巴斯克乳酪蛋糕，口味多樣。', query: 'Jon Cake Barcelona' },
                        { name: 'Cervecería Catalana', category: 'Tapas', price: '20-30', info: '生意最好名店，海鮮超新鮮，必點竹聖。', query: 'Cervecería Catalana Barcelona' },
                        { name: 'El Xampanyet', category: 'Tapas', price: '15-25', info: '氣氛熱鬧，主打Cava氣泡酒與鯷魚。', query: 'El Xampanyet Barcelona' },
                        { name: '7 Portes', category: '海鮮飯', price: '40-60', info: '百年老店，畢卡索來過，海鮮飯道地。', query: 'Restaurant 7 Portes' },
                        { name: 'Hofmann Pastisseria', category: '甜點', price: '5-8', info: '曾獲世界最佳可頌，馬斯卡彭口味必吃。', query: 'Hofmann Pastisseria Barcelona' },
                        { name: 'La Paradeta', category: '海鮮', price: '20-35', info: '像魚市場自己挑海鮮現煮，CP值高。', query: 'La Paradeta Born' },
                        { name: 'Vinitus', category: 'Tapas', price: '20-30', info: '同Cervecería系，鵝肝牛肉串必吃。', query: 'Vinitus Barcelona' },
                        { name: 'Can Paixano', category: '小吃', price: '5-10', info: '站著喝粉紅氣泡酒配漢堡，氣氛超嗨。', query: 'La Xampanyeria Barcelona' },
                        { name: 'Els Quatre Gats', category: '正餐', price: '30-45', info: '四隻貓餐廳，畢卡索混跡地，藝術氣息。', query: 'Els Quatre Gats Barcelona' },
                        { name: 'Pastisseria Escribà', category: '甜點', price: '5-15', info: '像珠寶店，必點紅唇蛋糕，推薦總店。', query: 'Pastisseria Escribà Gran Via de les Corts Catalanes' }
                    ]
                }
            };

            const currentCityData = cityData[activeCity];

            return (
                <div className="min-h-screen pb-20 font-sans text-gray-800">
                    {/* Header */}
                    <div className="bg-white shadow-md sticky top-0 z-50">
                        <div className="px-4 py-3 bg-gradient-to-r from-red-600 to-yellow-500 text-white flex justify-between items-center">
                            <div>
                                <h1 className="text-lg font-bold flex items-center gap-2"><BookOpen size={20} /> 城市伴讀</h1>
                                <p className="text-xs opacity-90">我的西班牙旅遊助手</p>
                            </div>
                            <div className="text-right text-xs">
                                <p>{currentTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</p>
                                <p>{new Date().toLocaleDateString()}</p>
                            </div>
                        </div>
                        <div className="flex overflow-x-auto no-scrollbar border-b">
                            {Object.keys(cityData).map((cityKey) => (
                                <button key={cityKey} onClick={() => { setActiveCity(cityKey); window.scrollTo(0,0); }} 
                                    className={`flex-none py-3 px-4 text-sm font-medium whitespace-nowrap transition-colors border-b-2 ${activeCity === cityKey ? 'border-red-600 text-red-600 bg-red-50' : 'border-transparent text-gray-500 hover:text-gray-700'}`}>
                                    {cityData[cityKey].name}
                                </button>
                            ))}
                        </div>
                        <div className="flex justify-around py-2 bg-gray-50 border-b text-xs text-gray-500 overflow-x-auto">
                            <button onClick={() => scrollToSection(attractionsRef)} className="flex items-center gap-1 hover:text-red-600 px-2"><Camera size={14}/> 景點</button>
                            <button onClick={() => scrollToSection(hiddenGemsRef)} className="flex items-center gap-1 hover:text-teal-600 px-2"><MapPin size={14}/> 遺珠</button>
                            <button onClick={() => scrollToSection(shoppingRef)} className="flex items-center gap-1 hover:text-purple-600 px-2"><ShoppingBag size={14}/> 購物</button>
                            <button onClick={() => scrollToSection(foodRef)} className="flex items-center gap-1 hover:text-orange-500 px-2"><Utensils size={14}/> 美食</button>
                        </div>
                    </div>

                    <div className="max-w-2xl mx-auto p-4 space-y-6">
                        {/* Weather */}
                        <div className="bg-white rounded-xl shadow-sm p-4 border border-gray-100 relative overflow-hidden min-h-[140px]">
                            <div className="absolute top-0 right-0 w-32 h-32 bg-blue-100 rounded-full mix-blend-multiply filter blur-2xl opacity-50 -translate-y-1/2 translate-x-1/2"></div>
                            <h2 className="text-gray-500 text-xs font-semibold uppercase tracking-wider mb-2 flex items-center gap-1"><MapPin size={12}/> 當地即時天氣 ({currentCityData.name})</h2>
                            {loadingWeather ? (
                                <div className="flex flex-col items-center justify-center py-4 text-gray-400"><Loader className="animate-spin mb-2" /><span className="text-xs">更新氣象數據中...</span></div>
                            ) : weatherData ? (
                                <div className="flex justify-between items-center z-10 relative mt-2">
                                    <div>
                                        <div className="flex items-end gap-2"><span className="text-4xl font-bold text-gray-800">{Math.round(weatherData.current.temperature_2m)}°C</span><span className="text-sm text-gray-500 mb-1">{getWeatherDesc(weatherData.current.weather_code)}</span></div>
                                        <div className="mt-2 text-xs text-gray-400">資料來源: Open-Meteo</div>
                                    </div>
                                    <div className="flex flex-col items-end gap-2">{getWeatherIcon(weatherData.current.weather_code, weatherData.current.is_day)}
                                        <div className="text-right text-xs text-gray-600 space-y-1 mt-1">
                                            <div className="flex items-center justify-end gap-1"><Sunrise size={14} className="text-orange-400"/> {new Date(weatherData.daily.sunrise[0]).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>
                                            <div className="flex items-center justify-end gap-1"><Sunset size={14} className="text-indigo-400"/> {new Date(weatherData.daily.sunset[0]).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>
                                        </div>
                                    </div>
                                </div>
                            ) : <div className="text-center text-sm text-red-400 py-4">無法取得天氣資訊</div>}
                        </div>

                        {/* Attractions */}
                        <section ref={attractionsRef} className="scroll-mt-36">
                            <div className="flex items-center gap-2 mb-4"><Camera className="text-red-600" size={20}/><h2 className="text-xl font-bold text-gray-800">精選景點</h2></div>
                            <div className="flex flex-wrap gap-2 pb-2 mb-4 w-full">
                                {currentCityData.attractions.map((spot, index) => (
                                    <button key={index} onClick={() => scrollToAttraction(`attraction-${index}`)} className="whitespace-nowrap px-3 py-1 rounded-full text-xs border border-gray-200 bg-white text-gray-600 hover:border-red-400 hover:text-red-500 transition-colors shadow-sm">{spot.name.split('(')[0]}</button>
                                ))}
                            </div>
                            <div className="space-y-6">
                                {currentCityData.attractions.map((spot, index) => (
                                    <div id={`attraction-${index}`} key={index} className="bg-white rounded-2xl shadow-sm overflow-hidden border border-gray-100 scroll-mt-40">
                                        <div className="bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 px-5 py-4"><h3 className="text-gray-800 font-bold text-xl flex items-center gap-2"><span className="w-2 h-6 bg-red-500 rounded-full inline-block"></span>{spot.name}</h3></div>
                                        <div className="p-5 space-y-5">
                                            <div className="flex flex-wrap gap-2 text-xs font-medium">
                                                <span className="px-2.5 py-1.5 bg-blue-50 text-blue-700 rounded-full flex items-center gap-1.5"><Clock size={12}/> {spot.info.split('|')[0].trim()}</span>
                                                {spot.info.split('|')[1] && <span className="px-2.5 py-1.5 bg-green-50 text-green-700 rounded-full flex items-center gap-1.5"><Info size={12}/> {spot.info.split('|')[1].trim()}</span>}
                                            </div>
                                            <div className="bg-amber-50/60 p-4 rounded-xl border border-amber-100 relative">
                                                <div className="flex justify-between items-start mb-2">
                                                    <h4 className="flex items-center gap-2 text-xs font-bold uppercase text-amber-600"><BookOpen size={14}/> 歷史速讀</h4>
                                                    <div className="flex gap-2">
                                                        <button onClick={() => searchBlogs(spot.name)} className="text-[10px] bg-white border border-amber-200 text-amber-600 px-2 py-1 rounded-md flex items-center gap-1 hover:bg-amber-100 transition-colors"><Search size={10} /> 搜遊記</button>
                                                        <button onClick={() => window.open(`https://zh.wikipedia.org/wiki/${encodeURIComponent(spot.name)}`, '_blank')} className="text-[10px] bg-white border border-amber-200 text-amber-600 px-2 py-1 rounded-md flex items-center gap-1 hover:bg-amber-100 transition-colors"><FileText size={10} /> 百科</button>
                                                    </div>
                                                </div>
                                                <p className="text-sm text-gray-700 leading-7 text-justify tracking-wide whitespace-pre-line">{spot.history}</p>
                                            </div>
                                            {spot.tips && <div className="bg-indigo-50/60 p-4 rounded-xl border border-indigo-100"><h4 className="flex items-center gap-2 text-xs font-bold uppercase text-indigo-600 mb-2"><Lightbulb size={14}/> 貼心小提醒</h4><ul className="space-y-2">{spot.tips.map((tip, i) => <li key={i} className="text-sm text-gray-700 flex items-start gap-2 leading-relaxed"><span className="text-indigo-400 mt-1.5 min-w-[6px] h-[6px] rounded-full bg-indigo-400 block"></span>{tip}</li>)}</ul></div>}
                                            <div>
                                                <h4 className="text-sm font-bold text-gray-800 mb-3 flex items-center gap-2"><Instagram size={16} className="text-pink-500"/> 景點 IG 常用 Hashtag</h4>
                                                <div className="flex flex-wrap gap-2">{spot.hashtags.map((tag, i) => <button key={i} className="px-3 py-1.5 bg-white border border-pink-100 text-pink-600 rounded-full text-xs font-medium hover:bg-pink-50 transition-colors flex items-center gap-1 shadow-sm" onClick={() => openHashtag(tag)}><Hash size={10} />{tag}</button>)}</div>
                                            </div>
                                            <a href={getGoogleMapsUrl(spot.name)} target="_blank" rel="noreferrer" className="flex items-center justify-center w-full py-3 bg-gray-800 text-white rounded-xl text-sm font-bold hover:bg-gray-700 transition-colors shadow-sm"><MapPin size={16} className="mr-2"/> 開啟地圖導航</a>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </section>

                        {/* Hidden Gems */}
                        <section ref={hiddenGemsRef} className="scroll-mt-36">
                            <div className="flex items-center gap-2 mb-4 mt-8"><MapPin className="text-teal-600" size={20}/><h2 className="text-xl font-bold text-gray-800">城市遺珠 (備案)</h2></div>
                            <div className="bg-white rounded-xl shadow-sm border border-gray-100 divide-y divide-gray-100">
                                {currentCityData.hiddenGems.map((gem, index) => (
                                    <div key={index} className="p-4 hover:bg-teal-50 transition-colors cursor-pointer group" onClick={() => window.open(getGoogleMapsUrl(gem.query || gem.name), '_blank')}>
                                        <div className="flex justify-between items-start">
                                            <div><h3 className="font-bold text-gray-800 group-hover:text-teal-700">{gem.name}</h3><p className="text-sm text-gray-500 mt-1">{gem.desc}</p></div>
                                            <ChevronRight size={16} className="text-gray-300 mt-1 group-hover:text-teal-500"/>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </section>

                        {/* Shopping */}
                        {currentCityData.shopping && (
                            <section ref={shoppingRef} className="scroll-mt-36">
                                <div className="flex items-center gap-2 mb-4 mt-8"><ShoppingBag className="text-purple-600" size={20}/><h2 className="text-xl font-bold text-gray-800">購物指南</h2></div>
                                <div className="bg-white rounded-xl shadow-sm border border-gray-100 divide-y divide-gray-100 mb-4">
                                    {currentCityData.shopping.map((shop, index) => (
                                        <div key={index} className="p-4 hover:bg-purple-50 transition-colors cursor-pointer group" onClick={() => window.open(getGoogleMapsUrl(shop.query), '_blank')}>
                                            <div className="flex justify-between items-start">
                                                <div>
                                                    <div className="flex items-center gap-2 mb-1"><h3 className="font-bold text-gray-800 group-hover:text-purple-700">{shop.name}</h3><span className="text-[10px] font-bold px-2 py-0.5 bg-purple-100 text-purple-600 rounded-full">{shop.type}</span></div>
                                                    <p className="text-sm text-gray-500">{shop.desc}</p>
                                                </div>
                                                <ChevronRight size={16} className="text-gray-300 mt-1 group-hover:text-purple-500"/>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                {currentCityData.souvenirs && (
                                    <div className="bg-purple-50/60 p-4 rounded-xl border border-purple-100">
                                        <h4 className="flex items-center gap-2 text-xs font-bold uppercase text-purple-600 mb-3"><Gift size={14}/> 必買伴手禮項目</h4>
                                        <div className="flex flex-wrap gap-2">{currentCityData.souvenirs.map((item, i) => <span key={i} className="px-3 py-1 bg-white border border-purple-200 text-purple-700 text-xs rounded-full shadow-sm">{item}</span>)}</div>
                                    </div>
                                )}
                            </section>
                        )}

                        {/* Food */}
                        <section ref={foodRef} className="scroll-mt-36">
                            <div className="flex items-center gap-2 mb-4 mt-8"><Utensils className="text-orange-500" size={20}/><h2 className="text-xl font-bold text-gray-800">必吃美食 ({currentCityData.food.length}選)</h2></div>
                            <div className="grid gap-4 sm:grid-cols-2">
                                {currentCityData.food.map((item, index) => (
                                    <a key={index} href={getGoogleMapsUrl(item.query || item.name)} target="_blank" rel="noreferrer" className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-all group flex flex-col justify-between">
                                        <div>
                                            <div className="flex justify-between items-start mb-2"><h3 className="font-bold text-gray-800 group-hover:text-orange-600 transition-colors line-clamp-1">{item.name}</h3><span className="text-[10px] font-bold px-2 py-1 bg-orange-50 text-orange-600 rounded-full border border-orange-100 whitespace-nowrap">{item.category}</span></div>
                                            <p className="text-xs text-gray-500 mb-3 leading-relaxed">{item.info}</p>
                                        </div>
                                        <div className="flex justify-between items-center border-t border-gray-50 pt-3 mt-1"><span className="text-xs font-medium text-gray-400 flex items-center">人均 <Euro size={10} className="ml-1"/>{item.price}</span><span className="text-xs text-blue-600 font-bold flex items-center gap-1 bg-blue-50 px-2 py-1 rounded-md">導航 <ChevronRight size={10}/></span></div>
                                    </a>
                                ))}
                            </div>
                        </section>

                        <div className="text-center text-gray-400 text-xs mt-12 mb-4 pb-safe"><p className="mb-2">🇪🇸 Hola! Enjoy your trip to Spain!</p><p>© 2026 城市伴讀</p></div>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<CityCompanion />);
    </script>
</body>
</html>
